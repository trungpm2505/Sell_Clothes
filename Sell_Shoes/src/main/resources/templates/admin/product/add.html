<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin/fragments/home.html}">
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
	<div layout:fragment="content">
	
		<style>
.pic>img {
	width: 50px;
	height: 50px;
	object-fit: contain;
}
#selected-images {
    display: flex;
}
.remove-selected-image:hover{
	cursor: pointer;
	color: red;
}
    #category:hover,
	#brand:hover {
	    cursor: pointer;
	}
	
	.truncate {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 100px; /* Điều chỉnh giá trị max-width theo ý muốn */
    }


</style>
		<div class="container-fluid">
		<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
			  <li class="nav-item">
			    <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Home</a>
			  </li>
			  <li class="nav-item">
			    <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Profile</a>
			  </li>
			  <li class="nav-item">
			    <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false">Contact</a>
			  </li>
		</ul>
		<div class="tab-content" id="pills-tabContent">
		  <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
		  
		  <div class="card mb-4">
				<!-- <div class="card-header py-3">
					<h2 class="m-0 font-weight-bold text-primary">Product</h2>
				</div> -->
				<div class="card-body">
				<div class="row justify-content-between">
					<div class="col-5">
						<h2>Add Product</h2>
						<div id="addProductForm">
							<div class="form-group">
								<input th:id="id" type="text" class="d-none">
								<div class="form-group">
									<label for="title" class="font-weight-bold">Title:</label> <input
										type="text" class="form-control" th:id="title" name="title"
										placeholder="Enter product title" required>
									<!-- Thẻ div để hiển thị thông báo lỗi -->
									<div th:id="title-error" class="text-danger form-text "></div>
								</div>
							</div>
							<!-- Select chọn category -->
							<div class="form-group">
								<label for="category" class="font-weight-bold">Category:</label>
								<select class="form-control" th:id="category"
									aria-label="Default select example">
									<option value="">Select category</option>
									<!-- Thêm các tùy chọn category khác nếu cần -->
								</select>
								<!-- Thẻ div để hiển thị thông báo lỗi -->
								<div th:id="category-error" class="text-danger form-text "></div>
							</div>
							<!-- Select chọn brand -->
							<div class="form-group">
								<label for="" brand"" class="font-weight-bold">Brand:</label> <select
									class="form-control" th:id="brand"
									aria-label="Default select example">
									<option value="">Select brand</option>
									<!-- Thêm các tùy chọn brand khác nếu cần -->
								</select>
								<!-- Thẻ div để hiển thị thông báo lỗi -->
								<div th:id="brand-error" class="text-danger form-text "></div>
							</div>
							<div class="form-group">
								<label for="description" class="font-weight-bold">Description:</label>
								<textarea class="form-control" th:id="discription"
									name="description" rows="4"
									placeholder="Enter product description" required></textarea>
								<!-- Thẻ div để hiển thị thông báo lỗi -->
								<div th:id="discription-error" class="text-danger form-text"></div>
							</div>
							<div class="input-group">
								<input type="file" class="form-control"
									placeholder="Recipient's username"
									aria-label="Recipient's username"
									aria-describedby="button-addon2" th:id="file-input" multiple>
								<button class="btn btn-danger" type="button"
									onclick="clearImage()" id="button-addon2">Clear image</button>
							</div>
							<div th:id="file-input-error" class="text-danger form-text"></div>
							<!-- Hiển thị các ảnh đã chọn -->
							<div th:id="selected-images"></div>
							<br>
							<!-- Add more product fields as needed -->
							<button type="submit" class="btn btn-primary"
								th:id="save-product-value" onclick="saveProduct()">Save
								changes</button>
							<button type="button" class="btn btn-danger" onclick="clearFrom()">Clear</button>
						</div>
					</div>
					
					<div class="col-7">
					<div class="row">
					<div class="col-7"></div>
						<div class="col-md-5">
									<div class="input-group">
										<input id="key" type="text" name="keyword5" value="" class="form-control"
											placeholder="Search by title">
										<div class="input-group-append">
											<button id="searchButton" class="btn btn-secondary">
												<i class="fas fa-search"></i>
											</button>
										</div>
									</div>
							</div>
						<table class="table table-striped" th:id="product-table">
							<thead>
								<tr>
									<th scope="col">#</th>
									<th scope="col">Image</th>
									<th scope="col">Title</th>
									<th scope="col">Category</th>
									<th scope="col">Brand</th>
									<th scope="col">Description</th>
									<th scope="col">CreateAt</th>
									<th scope="col">UpdateAt</th>
									<th scope="col"></th>
									<th></th>
									<th></th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<th>1</th>
									<td class="text-center"><img class="pic"
										src="https://www.freepnglogos.com/uploads/shoes-png/dance-shoes-png-transparent-dance-shoes-images-5.png"
										alt=""></td>
									<td>Mark</td>
									<td>Otto</td>
									<td>@mdo</td>
									<td></td>
									<td></td>
									<td>
										<button type="button" class="btn btn-primary"
											data-toggle="modal" data-target="#variantModal">Add
											Variant</button>
										<button class="btn btn-warning">Edit</button>
										<button class="btn btn-danger">Delete</button>
									</td>
								</tr>
							</tbody>
							<!-- Variant Modal -->
							<div class="modal fade" id="variantModal" tabindex="-1"
								role="dialog" aria-labelledby="variantModalLabel"
								aria-hidden="true">
								<div class="modal-dialog" role="document">
									<div class="modal-content">
										<div class="modal-header">
											<h5 class="modal-title" id="variantModalLabel">Add
												Variant</h5>
											<button type="button" class="close" data-dismiss="modal"
												aria-label="Close">
												<span aria-hidden="true">&times;</span>
											</button>
										</div>
										<div class="modal-body">
											<!-- Variant Form -->
	
											<!-- Add more variant fields as needed -->
	
											<button type="button" class="btn btn-success" id="addVariant">Add
												Variant</button>
										</div>
										<div class="modal-footer">
											<button type="button" class="btn btn-secondary"
												data-dismiss="modal">Close</button>
										</div>
									</div>
								</div>
							</div>
						</table>
						</div>
						<nav class="float-right" th:id="paging"></nav>
					</div>
					
				</div>
				<!-- Modal delete-->					
					<div class="modal fade" id="deleteProductmodal" tabindex="-1" role="dialog" aria-labelledby="confirmDeleteModalLabel" aria-hidden="true" data-backdrop="false">
					    <div class="modal-dialog" role="document">
					        <div class="modal-content">
					            <div class="modal-header">
					                <h5 class="modal-title" id="confirmDeleteModalLabel">Delete Product</h5>
					                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
					                    <span aria-hidden="true">&times;</span>
					                </button>
					            </div>
					            <div class="modal-body">
					                 <p>Are you sure you want to delete?</p>
					            </div>
					            <div class="modal-footer">
					                <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
					                <button type="button" class="btn btn-danger" id="delete-product-value">Xóa</button>
					            </div>
					        </div>
					    </div>
					</div>
				</div>
			</div>

			</div>
		  <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">...</div>
		  <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">...</div>
		</div>
			
		</div>
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script
			src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
		<script
			src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
		<script>
		
			var inputList = [ 'title', 'category', 'brand', 'discription', 'file-input' ];

			inputList.forEach(function(inputName) {
				var input = document.getElementById(inputName);
				var error = document.getElementById(inputName + '-error');

				if (input) { // Kiểm tra xem phần tử input có tồn tại không
					input.addEventListener("focus", function() {
						error.textContent = '';
					});
				} else {
					console.error("Element with id '" + inputName
							+ "' not found in the page.");
				}
			});
			
			function clearImage() {
				document.getElementById('file-input').value = null;
				//xóa khung chưa ảnh
				selectedImagesContainer.innerHTML = '';
				//xóa trong mảng chứa file
				selectedFiles.splice(0, selectedFiles.length);
				//xóa lỗi
				$("#file-input-error").text('');
			}
			
			loadCategory();
			function loadCategory() {
			    const categorySelect = document.getElementById('category');
			    $.ajax({
			        url: "/category/getAll",
			        type: "GET",
			        dataType: 'json',
			        success: function(categories) {
			        	if (categories.length != 0) {
			        		categorySelect.innerHTML = "<option value='' selected>Choose category</option>";
				    		  categories.forEach(function(category) {
				    			    const optionElement = document.createElement('option');
				    			    optionElement.value = category.id;
				    			    optionElement.textContent = category.name;
				    			    categorySelect.appendChild(optionElement);
				    			});
				    		  
				          } else {
				              
				          }
			        },
			        error: function(jqXHR, textStatus, errorMessage) {
			            var error = jqXHR.responseJSON || jqXHR.responseText;
			        }
			    });
			}
			
			loadBrand();
			function loadBrand() {
			    const brandSelect = document.getElementById('brand');
			    $.ajax({
			        url: "/brand/getAll",
			        type: "GET",
			        dataType: 'json',
			        success: function(brands) {
			        	if (brands.length != 0) {
			        		brandSelect.innerHTML = "<option value='' selected>Choose brand</option>";
			        		brands.forEach(function(brand) {
				    			    const optionElement = document.createElement('option');
				    			    optionElement.value = brand.id;
				    			    optionElement.textContent = brand.name;
				    			    brandSelect.appendChild(optionElement);
				    			});
				    		  
				          } else {
				              
				          }
			        },
			        error: function(jqXHR, textStatus, errorMessage) {
			            var error = jqXHR.responseJSON || jqXHR.responseText;
			        }
			    });
			}
			

			// Lấy khung hiển thị ảnh đã chọn
			const selectedImagesContainer = document.getElementById('selected-images');

			// Lấy khung chọn file
			const fileInput = document.getElementById('file-input');
			
			// Mảng chứa các file đã chọn
			let selectedFiles = [];
			
			// Xử lý sự kiện khi người dùng chọn file
			fileInput.addEventListener('change', function () {
			    imageChange();
			});
			
			function imageChange(){
				// Xóa các ảnh đã hiển thị trước đó
				   selectedFiles = [];
    selectedImagesContainer.innerHTML = '';

				    // Lấy danh sách các file đã chọn
				    if(fileInput != null){
						const files = fileInput.files;
						
						// Thêm các file mới vào mảng
					    for (let i = 0; i < files.length; i++) {
					        selectedFiles.push(files[i]);
					    }
					}
				    for (let i = 0; i < selectedFiles.length; i++) {
				    	// Tạo khung chứa ảnh
				        const imageContainer = document.createElement('div');
				        imageContainer.className = 'selected-image';
				        
				        // Tạo đối tượng ảnh
				        const image = document.createElement('img');
				     // Khi hiển thị ảnh, sử dụng đối tượng Blob hoặc File
				        if (selectedFiles[i] instanceof Blob || selectedFiles[i] instanceof File) {
				            image.src = URL.createObjectURL(selectedFiles[i]);
				        }

				        image.style.width = '100px';
				        
						
						// Tạo nút xóa ảnh
				        const removeButton = document.createElement('div');
				        removeButton.className = 'remove-selected-image';
				       	removeButton.innerHTML = '<i class="fas fa-times"></i>';
				        removeButton.style.marginBottom = '-4px';
						
						// Thêm nút xóa vào khung chứa
				        imageContainer.appendChild(removeButton);
				     // Thêm ảnh vào khung chứa
				        imageContainer.appendChild(image);
						
				        // Thêm khung chứa ảnh vào khung hiển thị ảnh đã chọn
				        selectedImagesContainer.appendChild(imageContainer);
				        // Xử lý sự kiện khi người dùng click nút xóa ảnh
				        removeButton.addEventListener('click', function(event){
						
				            selectedFiles.splice(i, 1);
				           	fileInput.value = null;
				            imageChange();
				        });
				      
			
				    }
			};
			
			var url1 ;
			var type1;
			clearFrom();
			function clearFrom() {
				console.log("clear");
				 url1 = "/product/add";
				 type1 = "POST";
				 $('#save-product-value').text('Save Changes');
				 
			    var inputId = ['id', 'title', 'category', 'brand','discription'];
			    inputId.forEach(function (input) {
			        document.getElementById(input).value = '';
			    });

			    var selectId = ['category'];
			    selectId.forEach(function (select) {
			        document.getElementById(select).selectedIndex = 0;
			    });

			    var inputList = ['title', 'category', 'brand', 'discription', 'file-input'];
			    inputList.forEach(function (error) {
			        var error = document.getElementById(error + '-error');
			        if (error !== null) {
			        	error.textContent = '';
			        }
			    });

			    clearImage();
			}
			
			//save product
			var csrfToken;
			function saveProduct(){
				var title = document.getElementById('title').value.trim();
				var category = document.getElementById("category").value;
				var brand = document.getElementById("brand").value;
				var discription = document.getElementById('discription').value.trim();
				
				 // Tạo đối tượng FormData để chứa dữ liệu
			    var formData = new FormData();
			 	// Thêm dữ liệu vào đối tượng FormData
			    if (url1 == "/product/update") {
			        formData.append('id', parseInt(document.getElementById('id').value)); // Nếu đang trong chế độ cập nhật sản phẩm, thêm giá trị id của sản phẩm vào formData.
			    }
			    formData.append('title', title);
			    
			    if (category != null && category != "") {
			        formData.append('category', parseInt(document.getElementById("category").value)); // Thêm giá trị loại sản phẩm vào formData nếu loại sản phẩm đã được chọn.
			    } else {
			        formData.append('category', ''); // Nếu không chọn loại sản phẩm, thêm giá trị trống vào formData.
			    }
			    
			    if (brand != null && brand != "") {
			        formData.append('brand', parseInt(document.getElementById("brand").value)); 
			    } else {
			        formData.append('brand', ''); 
			    }
			    
			    formData.append('discription', discription);
			    
			 	// Thêm các file được chọn vào đối tượng FormData
			     for (let i = 0; i < selectedFiles.length; i++) {
				    if (typeof selectedFiles[i] === 'string') {
				        formData.append('fileNames', selectedFiles[i]);
				    } else {
				        formData.append('file', selectedFiles[i]);
				    }
				}

			  	// Kiểm tra xem có ảnh được chọn hay không
			     if (selectedFiles.length === 0 || selectedFiles.length > 0) {
			         // Gắn giá trị mặc định cho defaultFileIndex
			         formData.append('defaultFileIndex', 0);
			     }
			  	
			  	
			     csrfToken = Cookies.get('XSRF-TOKEN');
			     $.ajax({
			    	 	url: url1,
				        type: type1,
				        contentType: false,
				        processData: false,
				        data: formData,
				        dataType: 'json',
				        headers: {
						    'X-XSRF-TOKEN': csrfToken
						  },
				        cache: false,
				        success: function(data) {
				        	showNotification(data.message); // Hiển thị thông báo thành công khi request thành công.
				            clearFrom(); 
				            
				            loadData(0, ""); 
				        },
				        error: function(jqXHR, textStatus, errorMessage) {
				            // Xử lý lỗi khi request không thành công.
				            if (jqXHR.status === 400) {
				                var errors = jqXHR.responseJSON;
				                if (errors.hasOwnProperty("bindingErrors")) {
				                    var bindingErrors = errors["bindingErrors"];
				                    for (var i = 0; i < bindingErrors.length; i++) {
				                        var error = bindingErrors[i];
				                        // Hiển thị thông báo lỗi trong các thẻ có ID đã tạo trước đó.
				                        $("#" + error.field + "-error").text(error.defaultMessage);
				                    }
				                }
				                if (errors.hasOwnProperty("fileErrors")) {
				                    var fileError = errors["fileErrors"];
				                    $("#file-input-error").text(fileError); // Hiển thị thông báo lỗi về file đính kèm nếu có.
				                }
				                if (errors.hasOwnProperty("titleDuplicate")) {
				                    var titleError = errors["titleDuplicate"];
				                    $("#title-error").text(titleError); // Hiển thị thông báo lỗi về tiêu đề sản phẩm trùng lặp nếu có.
				                }
				                /* if (errors.hasOwnProperty("NotFoundProduct")) {
				                    var titleError = errors["NotFoundProduct"];
				                    alert(titleError);
				                } */
				            } else {
				                alert("Sorry! The system has errors!"); // Hiển thị thông báo lỗi nếu request không thành công với mã lỗi khác 400.
				            }
				        }
				    });
			}
			
			
			loadData(0,"");
			var imageNames = [] ;
			function loadData(page, keyword) {
				var table = "#product-table tbody";
			    $.ajax({
			      url: '/product/getProductPage',
			      type: 'GET',
			      dataType: 'json',
			      data: {page : page, keyword : keyword},
			      success: function(data) {
			        //clear table
			        $(table).empty();
			
			        //add record
			        $.each(data.productResponseDtos, function(index, product) {
			        	var row = $('<tr>');
			            row.append($('<td>').text(data.currentPage * data.size + index+1));
			            
			            $.each(product.images, function(i,image) {
							imageNames.push(product.images[i].inmageForSave);
	  						if (product.images[i].isDefault == true) {
								  
								  row.append(
								  $('<td>').attr({
								    'data-imageList': imageNames
								  }).append(
								    $('<img>').attr('src', "../upload/"+image.inmageForSave+"?v=1")
								  ).addClass('pic')
								);
					  		}
					  	});
					  	
					  row.append($('<td>').text(product.id).addClass('id').css({
					    'display': 'none'
					  }));
			           row.append($('<td>').text(product.title).addClass('truncate'));
			           row.append($('<td>').text(product.categoryName).addClass('category'));
			           row.append($('<td>').text(product.brandName).addClass('brand'));
			            
			            row.append($('<td>').text(product.discription).addClass('discription truncate'));
			            row.append($('<td>').text(product.createAt).addClass('createAt'));
			            row.append($('<td>').text(product.updateAt).addClass('updateAt'));
			            
			            row.append($('<td>').attr({
			            	'data-id': product.id,
			            	'data-toggle': 'modal',
			            	'data-target': '#variantModal'
			            }).addClass('text-primary').html('<i class="fa fa-plus" aria-hidden="true"></i> Add Variant'))
			           
			            row.append($('<td>').addClass('edit-button').attr(
			            		'data-id', product.id).html('<i class="fas fa-pencil-alt"></i> Edit'));

			            
			            row.append($('<td>').attr({
			                'onclick': 'deleteProduct(' + product.id + ')'
			            }).addClass('text-danger').html('<i class="fas fa-trash"></i> Delete'));
			            
			            $(table).append(row);
			        });
			         pagination = '';
			         currentPage = data.currentPage;
			         totalPages = data.totalPages;
			         size = data.size;
			        //create pagination 
			      // createPagination("#paging",pagination,currentPage,totalPages,type,categoryId, keyword );
			        createPagination("#paging",pagination,currentPage,totalPages,keyword);
			      },
			      error: function(){}})
			  } 
			
			$(function() {
				$(document).on('click', '.edit-button', function() {
			    	console.log("edit");
			        clearFrom();
			    
			    	 var productId = parseInt($(this).data('id'), 10);

			    	// Kiểm tra xem productId có tồn tại không
			    	    if (typeof productId !== 'undefined') {
			    	    	 url1 = "/product/update";
					         type1 = "PUT";
					         $('#save-product-value').text('Update');
			    	        // Gửi yêu cầu AJAX đến máy chủ
			    	        $.ajax({
			    	            url: "/product/getProduct", 
			    	            type: "GET",  
			    	            data: { id: productId },
			    	            success: function(response) {
			    	            	document.getElementById('id').value = productId;
			    	            	document.getElementById('title').value = response.title;
			    	            	document.getElementById('category').value = response.categoryId;
			    	            	document.getElementById('brand').value = response.brandId;
			    	            	document.getElementById('discription').value = response.discription;
			    	            	
			    	            	
			    	            	const selectedImagesContainer = document.getElementById('selected-images');
			    	            	// Lấy danh sách ảnh từ phản hồi của máy chủ
			    	            	const imagesFromServer = response.images;

			    	            	// Lấy ra mảng các giá trị "inmageForSave"
			    	            	const inmageForSaveArray = imagesFromServer.map(image => image.inmageForSave);
			    	            	
			    	            	 for (let i = 0; i < inmageForSaveArray.length; i++) {
			 					        selectedFiles.push(inmageForSaveArray[i]);
			 					    }
			    	            	// Hàm hiển thị ảnh
			    	            	function displayImages(imageList) {
								    selectedImagesContainer.innerHTML = '';
								
								    imageList.forEach(function (imageSrc, i) {
								        // Tạo khung chứa ảnh
								        const imageContainer = document.createElement('div');
								        imageContainer.style.width = '110px';
								        imageContainer.className = 'selected-image';
								
								        // Tạo đối tượng ảnh
								        const image = document.createElement('img');
								        image.src = "../upload/" + imageSrc;
								        image.style.width = '110px';
								
								        // Tạo nút xóa ảnh
								        const removeButton = document.createElement('div');
								        removeButton.className = 'remove-selected-image';
								        removeButton.innerHTML = '<i class="fas fa-times"></i>';
								        removeButton.style.marginBottom = '0px';
								
								        // Thêm nút xóa vào khung chứa
								        imageContainer.appendChild(removeButton);
								
								        // Thêm ảnh vào khung chứa
								        imageContainer.appendChild(image);
								
								        // Thêm khung chứa ảnh vào khung hiển thị ảnh đã chọn
								        selectedImagesContainer.appendChild(imageContainer);
								
								        // Xử lý sự kiện khi người dùng click nút xóa ảnh
								        removeButton.addEventListener('click', function () {
								            imageList.splice(i, 1);
								            displayImages(imageList);
								        });
								    });
								}


			    	            	// Gọi hàm hiển thị ảnh với danh sách ảnh sẵn có
			    	            	displayImages(selectedFiles);

			    	            },
			    	            error: function(error) {
			    	                // Xử lý lỗi nếu có
			    	                console.error("Error:", error);
			    	            }
			    	        });
			    	    } 
			 	   });
			    });
			// Sự kiện show.bs.modal
			/* $('#deleteProduct').on('show.bs.modal', function (e) {
			    var deleteButton = e.relatedTarget;
			    var productId = $(deleteButton).data('id');
			    $('#productIdDeleteModal').val(productId);               
			}); */
						
			// Sự kiện click
			function deleteProduct(productId){
				$('#deleteProductmodal').modal("show");
				$('#delete-product-value').off("click").on("click", function() {
				    console.log("id",productId);
				    $.ajax({
				        url: '/product/delete?productId=' + productId,
				        type: 'DELETE',
				        success: function(data) {
				        	showNotification(data);
				        	loadData(0, "");
						    $('#deleteProductmodal').modal('hide');
				            
				        },
				        error: function(jqXHR, textStatus, errorThrown){
				            if (jqXHR.status === 400) {
				                var error = jqXHR.responseJSON || jqXHR.responseText;
				                alert(error)			
				                // Ẩn modal
				                $('#deleteProductmodal').modal('hide');
				            } else {
				                // Xử lý lỗi khác
				                console.log(textStatus);
				                console.log(errorThrown);
				            }
				        }
				    });
				});
			}
			
			 function createPagination(navId, pagination, currentPage, totalPages, keyWord ){
		    	  $(navId).empty();//xoa toan bo noi dung trong html có id navId(paging)
		          
		          pagination += '<ul class="pagination">';//tao danh sach 
		          //Thêm một nút điều hướng cho trang trước vào biến pagination nếu currentPage >0
		          pagination += '<li ' + (currentPage > 0 ? '' : 'class="page-item disabled"') + '><a class="page-link" onclick="' + (currentPage > 0 ? 'loadData(' + (currentPage - 1) +',\''+keyWord+'\')' : 'return false;') + '" aria-label="Previous"><span aria-hidden="true">&laquo;</span><span class="sr-only"></span></a></li>';

		              var startPage = currentPage > 2 ? currentPage - 2 : 0;
		              var endPage = currentPage + 2 < totalPages - 1 ? currentPage + 2 : totalPages - 1;
						
		              for (var i = startPage; i <= endPage; i++) {
		                  pagination += '<li ' + (currentPage === i ? 'class="page-item active"' : '') + '><a class="page-link" onclick="loadData(' + i +',\''+keyWord+'\')">' + (i + 1) + '</a></li>';
		              }
		              
		             //Nếu có quá nhiều trang (totalPages > 5) và trang hiện tại (currentPage) nhỏ hơn totalPages-3, hàm sẽ thêm một nút chấm ...
		              if ((totalPages > 5) &&  (currentPage < totalPages - 3)) {
		                  pagination += '<li class="page-item disabled"><a class="page-link" >...</a></li>';
		              }
		             //Nếu không phải là trang cuối cùng (totalPages-1 != currentPage) và trang hiện tại (currentPage) không phải là trang thứ hai từ cuối (totalPages-2 != currentPage) và trang hiện tại (currentPage) nhỏ hơn totalPages-3, hàm sẽ thêm nút điều hướng đến trang cuối cùng.
		              if ((totalPages > 1) && (totalPages-1 != currentPage) && (totalPages-2 != currentPage) && (currentPage<totalPages-3)) {
		                  pagination += '<li><a class="page-link" onclick="loadData(' + (totalPages - 1) +',\''+keyWord+'\')" >' + totalPages + '</a></li>';
		              }
					
		          pagination += '<li ' + (currentPage < totalPages - 1 ? '' : 'class="page-item disabled"') + '><a class="page-link" onclick="' + (currentPage < totalPages - 1 ? 'loadData(' + (currentPage + 1)+',\''+keyWord +'\')' : 'return false;') + '" aria-label="Next"><span aria-hidden="true">&raquo;</span><span class="sr-only"></span></a></li>';
		          pagination += '</ul>';
		           
		           $(navId).append(pagination);
		      }
			 function showNotification(data) {
				    $.notify(data, "success");
			}
			 
			 var searchButton = document.getElementById("searchButton");
			 var  keyInput = document.getElementById("key");
			 searchButton.addEventListener("click", function() {
				 var key="";
					
				 if(keyInput.value !== ""){
					
					 key = keyInput.value;
					 
				 }
				 loadData(0,key);
			});
			 
		</script>

	</div>

</body>
</html>